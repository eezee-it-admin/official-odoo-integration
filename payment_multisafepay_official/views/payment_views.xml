<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Payment methods -->
    <record id="payment_method_form_view_multisafepay" model="ir.ui.view">
        <field name="name">payment.method.form.view.multisafepay</field>
        <field name="model">payment.method</field>
        <field name="inherit_id" ref="payment.payment_method_form"/>
        <field name="arch" type="xml">
            <field name="support_tokenization" position='before'>
                <field name="title"/>
                <field name="provider" readonly="True"/>
                <field name="is_credit_card" readonly="True"/>
                <field name="editable_min_amount" invisible="True"/>
                <field name="is_generic_gateway" invisible="True"/>
                <field name="requires_shopping_cart" invisible="provider != 'multisafepay' or not is_generic_gateway" readonly="not is_generic_gateway"/>
                <field name="min_amount" nvisible="provider != 'multisafepay'" readonly="not editable_min_amount"/>
                <field name="editable_max_amount" invisible="1"/>
                <field name="max_amount" invisible="provider != 'multisafepay'" readonly="not editable_max_amount"/>
                <field name="customer_group" invisible="provider != 'multisafepay'"/>
            </field>
        </field>
    </record>

    <!-- Payment provider -->
    <record id="provider_form_multisafepay" model="ir.ui.view">
        <field name="name">provider.form.multisafepay</field>
        <field name="model">payment.provider</field>
        <field name="inherit_id" ref="payment.payment_provider_form"/>
        <field name="arch" type="xml">
            <group name="provider_credentials" position="inside">
                <group invisible="code != 'multisafepay'">
                    <field name="multisafepay_api_key_live"
                           required="code == 'multisafepay' and state == 'enabled'" password="True"/>
                    <field name="multisafepay_api_key_test"
                           required="code == 'multisafepay' and state == 'test'" password="True"/>
                </group>
            </group>
            <a name="action_view_payment_methods" position="attributes">
                <attribute name="invisible">state == 'disabled' or code == 'multisafepay'</attribute>
            </a>
            <a name="action_view_payment_methods" position="after">
                <a type="object" name="pull_merchant_payment_methods" class="btn btn-link" role="button" invisible="state == 'disabled' or code != 'multisafepay'">
                    <i class="oi oi-fw o_button_icon oi-arrow-right"/>
                    Pull Payment Methods From MultiSafePay
                </a>
            </a>
        </field>
    </record>

    <!-- Payment transaction -->
    <record id="transaction_form_multisafepay" model="ir.ui.view">
        <field name="name">transaction.form.multisafepay</field>
        <field name="model">payment.transaction</field>
        <field name="inherit_id" ref="payment.payment_transaction_form"/>
        <field name="arch" type="xml">
            <field name="provider_reference" position='after'>
                <field name="multisafepay_order_id"/>
            </field>
            <header position="inside">
                <button name="update_order" class="btn btn-primary"
                        string="Update invoice ID"
                        invisible="provider_code != 'multisafepay'"
                        groups="base.group_system"
                        type="object"/>
                <button name="update_tx_from_msp" class="btn btn-primary"
                        string="Update state from MSP"
                        invisible="provider_code != 'multisafepay'"
                        groups="base.group_system"
                        type="object"/>
            </header>
        </field>
    </record>

</odoo>
